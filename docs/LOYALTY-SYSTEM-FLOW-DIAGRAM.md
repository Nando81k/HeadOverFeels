# Loyalty System - Complete Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     CARE POINTS LOYALTY SYSTEM - PHASE 2                    â”‚
â”‚                           Automation Complete âœ…                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CUSTOMER SIGNUP                                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  POST /api/auth/signup                                                      â”‚
â”‚  {                                                                          â”‚
â”‚    email, password, name,                                                   â”‚
â”‚    referralCode: "FRIEND123" (optional)                                     â”‚
â”‚  }                                                                          â”‚
â”‚                                                                             â”‚
â”‚  â†“                                                                          â”‚
â”‚                                                                             â”‚
â”‚  1ï¸âƒ£  Validate referral code â†’ Find referrer                                â”‚
â”‚  2ï¸âƒ£  Assign "Head" tier (1x multiplier)                                    â”‚
â”‚  3ï¸âƒ£  Create customer with referredBy field                                 â”‚
â”‚  4ï¸âƒ£  Award +50 welcome points                                              â”‚
â”‚  5ï¸âƒ£  Increment referral code usage counter                                 â”‚
â”‚                                                                             â”‚
â”‚  âœ… Customer created with 50 points                                         â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FIRST PURCHASE                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Customer places order ($150)                                               â”‚
â”‚  â†’ Stripe processes payment                                                 â”‚
â”‚  â†’ Webhook: payment_intent.succeeded                                        â”‚
â”‚                                                                             â”‚
â”‚  POST /api/stripe/webhook                                                   â”‚
â”‚                                                                             â”‚
â”‚  â†“                                                                          â”‚
â”‚                                                                             â”‚
â”‚  1ï¸âƒ£  Update order status to CONFIRMED                                      â”‚
â”‚  2ï¸âƒ£  Send confirmation email                                               â”‚
â”‚  3ï¸âƒ£  Release cart reservations                                             â”‚
â”‚  4ï¸âƒ£  Reduce inventory                                                      â”‚
â”‚                                                                             â”‚
â”‚  ğŸ¯ LOYALTY AUTOMATION:                                                     â”‚
â”‚                                                                             â”‚
â”‚  5ï¸âƒ£  Check if first purchase â†’ YES                                         â”‚
â”‚                                                                             â”‚
â”‚      a) Award purchase points:                                              â”‚
â”‚         â€¢ Base: $150 Ã— 1pt/$1 = 150 points                                  â”‚
â”‚         â€¢ Tier multiplier: 150 Ã— 1.0 (Head) = 150 points                    â”‚
â”‚         â†’ +150 points                                                       â”‚
â”‚                                                                             â”‚
â”‚      b) Award first purchase bonus:                                         â”‚
â”‚         â†’ +100 points                                                       â”‚
â”‚                                                                             â”‚
â”‚      c) Check referredBy field â†’ Found referrer!                            â”‚
â”‚         â€¢ Referrer at Heart tier (1.25x)                                    â”‚
â”‚         â€¢ Award: 250 Ã— 1.25 = 313 points to referrer                        â”‚
â”‚         â†’ Referrer gets +313 points                                         â”‚
â”‚                                                                             â”‚
â”‚  6ï¸âƒ£  Update annual spend: $0 â†’ $150                                        â”‚
â”‚  7ï¸âƒ£  Check tier upgrade: $150 < $200 â†’ No upgrade yet                      â”‚
â”‚                                                                             â”‚
â”‚  âœ… Customer now has: 50 (welcome) + 150 (purchase) + 100 (bonus) = 300    â”‚
â”‚  âœ… Referrer now has: +313 points                                           â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  REVIEW SUBMISSION & APPROVAL                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  POST /api/reviews                                                          â”‚
â”‚  {                                                                          â”‚
â”‚    productId, customerId, rating: 5,                                        â”‚
â”‚    comment: "Love this product!"                                            â”‚
â”‚  }                                                                          â”‚
â”‚  â†’ Status: PENDING                                                          â”‚
â”‚                                                                             â”‚
â”‚  â†“ (Admin reviews in admin panel)                                          â”‚
â”‚                                                                             â”‚
â”‚  PATCH /api/reviews/[id]                                                    â”‚
â”‚  { status: "APPROVED" }                                                     â”‚
â”‚                                                                             â”‚
â”‚  â†“                                                                          â”‚
â”‚                                                                             â”‚
â”‚  ğŸ¯ LOYALTY AUTOMATION:                                                     â”‚
â”‚                                                                             â”‚
â”‚  1ï¸âƒ£  Check: status changed from PENDING â†’ APPROVED? YES                    â”‚
â”‚  2ï¸âƒ£  Award review points:                                                  â”‚
â”‚      â€¢ Base: 25 points                                                      â”‚
â”‚      â€¢ Customer at Head tier (1.0x)                                         â”‚
â”‚      â€¢ Award: 25 Ã— 1.0 = 25 points                                          â”‚
â”‚      â†’ +25 points                                                           â”‚
â”‚                                                                             â”‚
â”‚  âœ… Customer now has: 300 + 25 = 325 points                                 â”‚
â”‚                                                                             â”‚
â”‚  Note: Re-approving same review = no duplicate points                       â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SECOND PURCHASE (Tier Upgrade)                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Customer places another order ($75)                                        â”‚
â”‚  â†’ Stripe webhook fires again                                               â”‚
â”‚                                                                             â”‚
â”‚  ğŸ¯ LOYALTY AUTOMATION:                                                     â”‚
â”‚                                                                             â”‚
â”‚  1ï¸âƒ£  Check if first purchase â†’ NO (already has orders)                     â”‚
â”‚                                                                             â”‚
â”‚  2ï¸âƒ£  Award purchase points only:                                           â”‚
â”‚      â€¢ Base: $75 Ã— 1pt/$1 = 75 points                                       â”‚
â”‚      â€¢ Tier multiplier: 75 Ã— 1.0 (Head) = 75 points                         â”‚
â”‚      â†’ +75 points                                                           â”‚
â”‚                                                                             â”‚
â”‚  3ï¸âƒ£  Update annual spend: $150 + $75 = $225                                â”‚
â”‚                                                                             â”‚
â”‚  4ï¸âƒ£  Check tier upgrade:                                                   â”‚
â”‚      â€¢ Current: Head ($0 minimum)                                           â”‚
â”‚      â€¢ Next: Heart ($200 minimum)                                           â”‚
â”‚      â€¢ Annual spend: $225 â‰¥ $200? YES!                                      â”‚
â”‚      â†’ UPGRADE TO HEART TIER! ğŸ‰                                            â”‚
â”‚                                                                             â”‚
â”‚  5ï¸âƒ£  Tier upgrade bonus:                                                   â”‚
â”‚      â€¢ Award: 100 Ã— 1.25 (new tier) = 125 points                            â”‚
â”‚      â†’ +125 points                                                          â”‚
â”‚                                                                             â”‚
â”‚  âœ… Customer now has: 325 + 75 + 125 = 525 points                           â”‚
â”‚  âœ… Customer upgraded to Heart tier (1.25x multiplier)                      â”‚
â”‚  âœ… All future points now get 1.25x boost!                                  â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BIRTHDAY POINTS (Automatic)                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  CRON JOB (runs daily at midnight)                                          â”‚
â”‚  POST /api/cron/birthday-points                                             â”‚
â”‚  Authorization: Bearer CRON_SECRET                                          â”‚
â”‚                                                                             â”‚
â”‚  â†“                                                                          â”‚
â”‚                                                                             â”‚
â”‚  1ï¸âƒ£  Query all customers with birthday = today                             â”‚
â”‚  2ï¸âƒ£  For each birthday customer:                                           â”‚
â”‚                                                                             â”‚
â”‚      â€¢ Customer at Heart tier (1.25x)                                       â”‚
â”‚      â€¢ Base birthday points: 50                                             â”‚
â”‚      â€¢ With multiplier: 50 Ã— 1.25 = 63 points                               â”‚
â”‚      â†’ +63 points                                                           â”‚
â”‚                                                                             â”‚
â”‚  3ï¸âƒ£  Log results and send report                                           â”‚
â”‚                                                                             â”‚
â”‚  âœ… Customer now has: 525 + 63 = 588 points                                 â”‚
â”‚                                                                             â”‚
â”‚  Schedule via:                                                              â”‚
â”‚  â€¢ Vercel Cron (vercel.json)                                                â”‚
â”‚  â€¢ GitHub Actions (.github/workflows/)                                      â”‚
â”‚  â€¢ External service (cron-job.org, etc.)                                    â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  POINTS SUMMARY                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Customer's Journey (Year 1):                                               â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ Action                 â”‚ Base Pts   â”‚ Tier         â”‚ Final Pts    â”‚     â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚
â”‚  â”‚ Signup                 â”‚ +50        â”‚ None (base)  â”‚ +50          â”‚     â”‚
â”‚  â”‚ First Purchase ($150)  â”‚ +150       â”‚ 1.0x (Head)  â”‚ +150         â”‚     â”‚
â”‚  â”‚ First Purchase Bonus   â”‚ +100       â”‚ None (bonus) â”‚ +100         â”‚     â”‚
â”‚  â”‚ Approved Review        â”‚ +25        â”‚ 1.0x (Head)  â”‚ +25          â”‚     â”‚
â”‚  â”‚ Second Purchase ($75)  â”‚ +75        â”‚ 1.0x (Head)  â”‚ +75          â”‚     â”‚
â”‚  â”‚ Tier Upgrade Bonus     â”‚ +100       â”‚ 1.25x (Heart)â”‚ +125         â”‚     â”‚
â”‚  â”‚ Birthday               â”‚ +50        â”‚ 1.25x (Heart)â”‚ +63          â”‚     â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚
â”‚  â”‚ TOTAL EARNED                                       â”‚ 588 points   â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                             â”‚
â”‚  Can Redeem:                                                                â”‚
â”‚  âœ… Free Shipping (900 pts) - Need 312 more                                 â”‚
â”‚  âœ… $5 Off (500 pts) - Can redeem now!                                      â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TIER PROGRESSION                                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  ğŸ§  HEAD                  â¤ï¸  HEART                                         â”‚
â”‚  â”œâ”€ $0/year              â”œâ”€ $200/year                                       â”‚
â”‚  â”œâ”€ 1.0x multiplier      â”œâ”€ 1.25x multiplier                                â”‚
â”‚  â”œâ”€ Base benefits        â”œâ”€ Free shipping                                   â”‚
â”‚  â””â”€ Starting tier        â”œâ”€ Early drop access (24hr)                        â”‚
â”‚                          â””â”€ Tier upgrade bonus                              â”‚
â”‚                                                                             â”‚
â”‚  ğŸ§˜ MIND                  âš¡ OVERDRIVE                                       â”‚
â”‚  â”œâ”€ $500/year            â”œâ”€ Invite-only (top 1%)                            â”‚
â”‚  â”œâ”€ 1.5x multiplier      â”œâ”€ 2.0x multiplier                                 â”‚
â”‚  â”œâ”€ All Heart benefits   â”œâ”€ All Mind benefits                               â”‚
â”‚  â”œâ”€ Exclusive products   â”œâ”€ Personal concierge                              â”‚
â”‚  â”œâ”€ Priority support     â”œâ”€ Members wall feature                            â”‚
â”‚  â””â”€ Birthday 2x bonus    â””â”€ VIP events access                               â”‚
â”‚                                                                             â”‚
â”‚  Customer's Current Status:                                                 â”‚
â”‚  â€¢ Tier: â¤ï¸ Heart (1.25x)                                                   â”‚
â”‚  â€¢ Annual Spend: $225                                                       â”‚
â”‚  â€¢ Points: 588                                                              â”‚
â”‚  â€¢ Next Tier: ğŸ§˜ Mind (needs $275 more)                                     â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DATABASE TRACKING (Full Audit Trail)                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  PointsTransaction Table:                                                   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ ID    â”‚ Type           â”‚ Points â”‚ Description     â”‚ Metadata      â”‚     â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚
â”‚  â”‚ tx_01 â”‚ ACCOUNT_CREATE â”‚ +50    â”‚ Welcome bonus   â”‚ {}            â”‚     â”‚
â”‚  â”‚ tx_02 â”‚ PURCHASE       â”‚ +150   â”‚ Order #ORD-001  â”‚ {orderId,...} â”‚     â”‚
â”‚  â”‚ tx_03 â”‚ FIRST_PURCHASE â”‚ +100   â”‚ First order     â”‚ {orderId,...} â”‚     â”‚
â”‚  â”‚ tx_04 â”‚ REVIEW         â”‚ +25    â”‚ Review #REV-01  â”‚ {reviewId,..} â”‚     â”‚
â”‚  â”‚ tx_05 â”‚ PURCHASE       â”‚ +75    â”‚ Order #ORD-002  â”‚ {orderId,...} â”‚     â”‚
â”‚  â”‚ tx_06 â”‚ TIER_UPGRADE   â”‚ +125   â”‚ Upgradedâ†’Heart  â”‚ {tierId,...}  â”‚     â”‚
â”‚  â”‚ tx_07 â”‚ BIRTHDAY       â”‚ +63    â”‚ Birthday gift   â”‚ {}            â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                             â”‚
â”‚  â€¢ Never deleted (permanent audit trail)                                    â”‚
â”‚  â€¢ Includes metadata (order ID, tier multiplier, etc.)                      â”‚
â”‚  â€¢ Supports negative values for redemptions                                 â”‚
â”‚  â€¢ Optional expiry dates for time-limited bonuses                           â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  API ENDPOINTS (Available Now)                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  GET /api/loyalty/customers/[customerId]/stats                              â”‚
â”‚  â†’ Returns: points, tier, history, progress to next tier                    â”‚
â”‚                                                                             â”‚
â”‚  GET /api/loyalty/customers/[customerId]/rewards                            â”‚
â”‚  â†’ Returns: available rewards (filtered by tier & points)                   â”‚
â”‚                                                                             â”‚
â”‚  GET /api/loyalty/customers/[customerId]/referral                           â”‚
â”‚  â†’ Returns: unique referral code & usage stats                              â”‚
â”‚                                                                             â”‚
â”‚  POST /api/cron/birthday-points                                             â”‚
â”‚  â†’ Triggers: birthday points for all customers with today's birthday        â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  NEXT: PHASE 3 - CUSTOMER UI                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Coming Soon:                                                               â”‚
â”‚  1. Loyalty Dashboard Page (/loyalty)                                       â”‚
â”‚  2. Points Balance Widget (in navigation)                                   â”‚
â”‚  3. Rewards Catalog Page (/loyalty/rewards)                                 â”‚
â”‚  4. Redemption Flow (modals + checkout integration)                         â”‚
â”‚  5. Tier Progress Visualization                                             â”‚
â”‚  6. Referral Sharing Widget                                                 â”‚
â”‚                                                                             â”‚
â”‚  Ready to build? Say: "Let's move on to Phase 3"                            â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
